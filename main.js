(()=>{var t={571:function(t,e,n){var r,a,o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(a,o){function i(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=e.call(t,i)}catch(t){o=[6,t],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};r=[n,e,n(200),n(749),n(159),n(310),n(297),n(963)],a=function(t,e,n,r,a,s,c,u){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ColorReducer=e.ColorMapResult=void 0;var l=function(){};e.ColorMapResult=l;var h=function(){function t(){}return t.createColorMap=function(t){for(var e=new c.Uint8Array2D(t.width,t.height),n=0,r={},a=[],o=0,i=0;i<t.height;i++)for(var s=0;s<t.width;s++){var u=t.data[o++],h=t.data[o++],f=t.data[o++],d=void t.data[o++],p=u+","+h+","+f;void 0===r[p]?(d=n,r[p]=n,a.push([u,h,f]),n++):d=r[p],e.set(s,i,d)}var g=new l;return g.imgColorIndices=e,g.colorsByIndex=a,g.width=t.width,g.height=t.height,g},t.applyKMeansClustering=function(e,c,l,h,f){return void 0===f&&(f=null),o(this,void 0,void 0,(function(){var o,l,d,p,g,y,v,b,m,w,x,P,C,M,S,k,F,E,_;return i(this,(function(i){switch(i.label){case 0:for(o=[],l=0,d=0,p={},g=0;g<e.height;g++)for(y=0;y<e.width;y++)v=e.data[l++],b=e.data[l++],m=e.data[l++],e.data[l++],b=b>>2<<2,m=m>>2<<2,(P="".concat(v=v>>2<<2,",").concat(b,",").concat(m))in p?p[P].push(g*e.width+y):p[P]=[g*e.width+y];for(w=0,x=Object.keys(p);w<x.length;w++)P=x[w],C=P.split(",").map((function(t){return parseInt(t)})),void 0,M=h.kMeansClusteringColorSpace===s.ClusteringColorSpace.RGB?C:h.kMeansClusteringColorSpace===s.ClusteringColorSpace.HSL?(0,a.rgbToHsl)(C[0],C[1],C[2]):h.kMeansClusteringColorSpace===s.ClusteringColorSpace.LAB?(0,a.rgb2lab)(C):C,S=p[P].length/(e.width*e.height),(k=new r.Vector(M,S)).tag=C,o[d++]=k;F=new u.Random(0===h.randomSeed?(new Date).getTime():h.randomSeed),E=new r.KMeans(o,h.kMeansNrOfClusters,F),_=(new Date).getTime(),E.step(),i.label=1;case 1:return E.currentDeltaDistanceDifference>h.kMeansMinDeltaDifference?(E.step(),(new Date).getTime()-_>500?(_=(new Date).getTime(),[4,(0,n.delay)(0)]):[3,3]):[3,4];case 2:i.sent(),null!=f&&(t.updateKmeansOutputImageData(E,h,p,e,c,!1),f(E)),i.label=3;case 3:return[3,1];case 4:return t.updateKmeansOutputImageData(E,h,p,e,c,!0),null!=f&&f(E),[2]}}))}))},t.updateKmeansOutputImageData=function(t,e,n,r,o,i){for(var c=0;c<t.centroids.length;c++)for(var u=t.centroids[c],l=0,h=t.pointsPerCategory[c];l<h.length;l++){var f=h[l],d=void 0;if(e.kMeansClusteringColorSpace===s.ClusteringColorSpace.RGB)d=u.values;else if(e.kMeansClusteringColorSpace===s.ClusteringColorSpace.HSL){var p=u.values;d=(0,a.hslToRgb)(p[0],p[1],p[2])}else if(e.kMeansClusteringColorSpace===s.ClusteringColorSpace.LAB){var g=u.values;d=(0,a.lab2rgb)(g)}else d=u.values;if(d=d.map((function(t){return Math.floor(t)})),i&&e.kMeansColorRestrictions.length>0){for(var y=Number.MAX_VALUE,v=null,b=0,m=e.kMeansColorRestrictions;b<m.length;b++){var w,x=m[b],P=(0,a.rgb2lab)(d);w="string"==typeof x?(0,a.rgb2lab)(e.colorAliases[x]):(0,a.rgb2lab)(x);var C=Math.sqrt((P[0]-w[0])*(P[0]-w[0])+(P[1]-w[1])*(P[1]-w[1])+(P[2]-w[2])*(P[2]-w[2]));C<y&&(y=C,v=x)}null!==v&&(d="string"==typeof v?e.colorAliases[v]:v)}for(var M=f.tag,S=0,k=n["".concat(Math.floor(M[0]),",").concat(Math.floor(M[1]),",").concat(Math.floor(M[2]))];S<k.length;S++){var F=k[S],E=F%r.width,_=4*(Math.floor(F/r.width)*r.width+E);o.data[_++]=d[0],o.data[_++]=d[1],o.data[_++]=d[2]}}},t.buildColorDistanceMatrix=function(t){for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=new Array(e.length);for(n=0;n<t.length;n++)for(var r=n;r<t.length;r++){var a=t[n],o=t[r],i=Math.sqrt((a[0]-o[0])*(a[0]-o[0])+(a[1]-o[1])*(a[1]-o[1])+(a[2]-o[2])*(a[2]-o[2]));e[r][n]=i,e[n][r]=i}return e},t.processNarrowPixelStripCleanup=function(e){return o(this,void 0,void 0,(function(){var n,r,a,o,s,c,u,l,h,f,d,p,g,y;return i(this,(function(i){for(n=t.buildColorDistanceMatrix(e.colorsByIndex),r=0,a=e.imgColorIndices,o=1;o<e.height-1;o++)for(s=1;s<e.width-1;s++)c=a.get(s,o-1),u=a.get(s,o+1),l=a.get(s-1,o),h=a.get(s+1,o),(f=a.get(s,o))!==c&&f!==u&&f!==l&&f!==h||(f!==c&&f!==u?(d=n[f][c],p=n[f][u],a.set(s,o,d<p?c:u),r++):f!==l&&f!==h&&(g=n[f][l],y=n[f][h],a.set(s,o,g<y?l:h),r++));return console.log(r+" pixels replaced to remove narrow pixel strips"),[2]}))}))},t}();e.ColorReducer=h}.apply(e,r),void 0===a||(t.exports=a)},200:function(t,e,n){var r,a=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(a,o){function i(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,s)}c((r=r.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=e.call(t,i)}catch(t){o=[6,t],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};r=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CancellationToken=e.delay=void 0,e.delay=function(t){return a(this,void 0,void 0,(function(){return o(this,(function(e){return"undefined"!=typeof window?[2,new Promise((function(e){return window.setTimeout(e,t)}))]:[2,new Promise((function(t){return t()}))]}))}))};e.CancellationToken=function(){this.isCancelled=!1}}.apply(e,[n,e]),void 0===r||(t.exports=r)},783:function(t,e,n){var r,a,o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(a,o){function i(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=e.call(t,i)}catch(t){o=[6,t],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};r=[n,e,n(200),n(946),n(144)],a=function(t,e,n,r,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FacetBorderSegmenter=e.FacetBoundarySegment=e.PathSegment=void 0;var s=function(t,e){this.points=t,this.neighbour=e};e.PathSegment=s;var c=function(t,e,n){this.originalSegment=t,this.neighbour=e,this.reverseOrder=n};e.FacetBoundarySegment=c;var u=function(){function t(){}return t.buildFacetBorderSegments=function(e,n,r){return void 0===n&&(n=2),void 0===r&&(r=null),o(this,void 0,void 0,(function(){var a;return i(this,(function(o){switch(o.label){case 0:return a=t.prepareSegmentsPerFacet(e),t.reduceSegmentComplexity(e,a,n),[4,t.matchSegmentsWithNeighbours(e,a,r)];case 1:return o.sent(),[2]}}))}))},t.prepareSegmentsPerFacet=function(t){for(var e=new Array(t.facets.length),n=0,r=t.facets;n<r.length;n++){var o=r[n];if(null!=o){var i=[];if(o.borderPath.length>1){var c=[];c.push(o.borderPath[0]);for(var u=1;u<o.borderPath.length;u++){var l=o.borderPath[u-1],h=o.borderPath[u],f=!1;if((p=l.getNeighbour(t))!==h.getNeighbour(t)?f=!0:-1!==p&&l.x===h.x&&l.y===h.y&&(l.orientation===a.OrientationEnum.Top&&h.orientation===a.OrientationEnum.Left||l.orientation===a.OrientationEnum.Left&&h.orientation===a.OrientationEnum.Top?t.facetMap.get(h.x-1,h.y-1)!==p&&(f=!0):l.orientation===a.OrientationEnum.Top&&h.orientation===a.OrientationEnum.Right||l.orientation===a.OrientationEnum.Right&&h.orientation===a.OrientationEnum.Top?t.facetMap.get(h.x+1,h.y-1)!==p&&(f=!0):l.orientation===a.OrientationEnum.Bottom&&h.orientation===a.OrientationEnum.Left||l.orientation===a.OrientationEnum.Left&&h.orientation===a.OrientationEnum.Bottom?t.facetMap.get(h.x-1,h.y+1)!==p&&(f=!0):(l.orientation===a.OrientationEnum.Bottom&&h.orientation===a.OrientationEnum.Right||l.orientation===a.OrientationEnum.Right&&h.orientation===a.OrientationEnum.Bottom)&&t.facetMap.get(h.x+1,h.y+1)!==p&&(f=!0)),c.push(h),f&&c.length>1){var d=new s(c,p);i.push(d),c=[h]}}if(c.length>1){var p=o.borderPath[o.borderPath.length-1].getNeighbour(t);if(i.length>0&&i[0].neighbour===p){var g=c.concat(i[0].points);i[0].points=g}else d=new s(c,p),i.push(d),c=[]}}e[o.id]=i}}return e},t.reduceSegmentComplexity=function(e,n,r){for(var a=0,o=e.facets;a<o.length;a++){var i=o[a];if(null!=i)for(var s=0,c=n[i.id];s<c.length;s++)for(var u=c[s],l=0;l<r;l++)u.points=t.reduceSegmentHaarWavelet(u.points,!0,e.width,e.height)}},t.reduceSegmentHaarWavelet=function(e,n,o,i){if(e.length<=5)return e;var s=[];s.push(e[0]);for(var c=1;c<e.length-2;c+=2)if(!n||n&&!t.isOutsideBorderPoint(e[c],o,i)){var u=(e[c].x+e[c+1].x)/2,l=(e[c].y+e[c+1].y)/2;s.push(new a.PathPoint(new r.Point(u,l),a.OrientationEnum.Left))}else s.push(e[c]),s.push(e[c+1]);return s.push(e[e.length-1]),s},t.isOutsideBorderPoint=function(t,e,n){return 0===t.x||0===t.y||t.x===e-1||t.y===n-1},t.calculateArea=function(t){for(var e=0,n=0;n<t.length;n++)e+=t[n].x*t[n===t.length-1?0:n+1].y*.5,e-=t[n===t.length-1?0:n+1].x*t[n].y*.5;return Math.abs(e)},t.matchSegmentsWithNeighbours=function(t,e,r){return void 0===r&&(r=null),o(this,void 0,void 0,(function(){var a,o,s,u,l,h,f,d,p,g,y,v,b,m,w,x,P,C,M;return i(this,(function(i){switch(i.label){case 0:for(a=4,o=0,s=t.facets;o<s.length;o++)null!=(f=s[o])&&(f.borderSegments=new Array(e[f.id].length));u=0,l=0,h=t.facets,i.label=1;case 1:if(!(l<h.length))return[3,5];if(null==(f=h[l]))return[3,3];for(!1,d=0;d<e[f.id].length;d++){if(null!=(p=e[f.id][d])&&null==f.borderSegments[d]&&(f.borderSegments[d]=new c(p,p.neighbour,!1),-1!==p.neighbour)&&null!=(g=t.facets[p.neighbour]))for(y=e[p.neighbour],v=0;v<y.length;v++)if(null!=(b=y[v])&&b.neighbour===f.id){if(m=p.points[0],w=p.points[p.points.length-1],x=b.points[0],P=b.points[b.points.length-1],C=m.distanceTo(x)<=a&&w.distanceTo(P)<=a,M=m.distanceTo(P)<=a&&w.distanceTo(x)<=a,C&&M&&(m.distanceTo(x)+w.distanceTo(P)<m.distanceTo(P)+w.distanceTo(x)?(C=!0,M=!1):(C=!1,M=!0)),C){g.borderSegments[v]=new c(p,f.id,!1),e[g.id][v]=null;break}if(M){g.borderSegments[v]=new c(p,f.id,!0),e[g.id][v]=null;break}}e[f.id][d]=null}return u%100!=0?[3,3]:[4,(0,n.delay)(0)];case 2:i.sent(),null!=r&&r(f.id/t.facets.length),i.label=3;case 3:u++,i.label=4;case 4:return l++,[3,1];case 5:return null!=r&&r(1),[2]}}))}))},t}();e.FacetBorderSegmenter=u}.apply(e,r),void 0===a||(t.exports=a)},194:function(t,e,n){var r,a,o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(a,o){function i(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=e.call(t,i)}catch(t){o=[6,t],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};r=[n,e,n(200),n(946),n(297),n(144)],a=function(t,e,n,r,a,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FacetBorderTracer=void 0;var c=function(){function t(){}return t.buildFacetBorderPaths=function(e,r){return void 0===r&&(r=null),o(this,void 0,void 0,(function(){var o,c,u,l,h,f,d,p,g,y,v,b,m,w;return i(this,(function(i){switch(i.label){case 0:o=0,c=new a.BooleanArray2D(e.width,e.height),u=e.facets.filter((function(t){return null!=t})).slice(0).sort((function(t,e){return e.pointCount>t.pointCount?1:e.pointCount<t.pointCount?-1:0})).map((function(t){return t.id})),l=0,i.label=1;case 1:if(!(l<u.length))return[3,5];if(null==(h=e.facets[u[l]]))return[3,3];for(f=0,d=h.borderPoints;f<d.length;f++)p=d[f],c.set(p.x,p.y,!0);for(g=new a.BooleanArray2D(e.width+1,e.height+1),y=new a.BooleanArray2D(e.width+1,e.height+1),v=-1,b=0;b<h.borderPoints.length;b++)if(h.borderPoints[b].x===h.bbox.minX||h.borderPoints[b].x===h.bbox.maxX||h.borderPoints[b].y===h.bbox.minY||h.borderPoints[b].y===h.bbox.maxY){v=b;break}return(m=new s.PathPoint(h.borderPoints[v],s.OrientationEnum.Left)).x-1<0||e.facetMap.get(m.x-1,m.y)!==h.id?m.orientation=s.OrientationEnum.Left:m.y-1<0||e.facetMap.get(m.x,m.y-1)!==h.id?m.orientation=s.OrientationEnum.Top:m.x+1>=e.width||e.facetMap.get(m.x+1,m.y)!==h.id?m.orientation=s.OrientationEnum.Right:(m.y+1>=e.height||e.facetMap.get(m.x,m.y+1)!==h.id)&&(m.orientation=s.OrientationEnum.Bottom),w=t.getPath(m,e,h,c,g,y),h.borderPath=w,o%100!=0?[3,3]:[4,(0,n.delay)(0)];case 2:i.sent(),null!=r&&r(l/u.length),i.label=3;case 3:o++,i.label=4;case 4:return l++,[3,1];case 5:return null!=r&&r(1),[2]}}))}))},t.getPath=function(e,n,a,o,i,c){var u=!1,l=[];for(t.addPointToPath(l,e,i,a,c);!u;){var h=[];if(e.orientation===s.OrientationEnum.Left){if((e.y-1>=0&&n.facetMap.get(e.x,e.y-1)!==a.id||e.y-1<0)&&!c.get(e.x,e.y)){var f=new s.PathPoint(new r.Point(e.x,e.y),s.OrientationEnum.Top);h.push(f)}(e.y+1<n.height&&n.facetMap.get(e.x,e.y+1)!==a.id||e.y+1>=n.height)&&!c.get(e.x,e.y+1)&&(f=new s.PathPoint(new r.Point(e.x,e.y),s.OrientationEnum.Bottom),h.push(f)),e.y-1>=0&&n.facetMap.get(e.x,e.y-1)===a.id&&(e.x-1<0||n.facetMap.get(e.x-1,e.y-1)!==a.id)&&o.get(e.x,e.y-1)&&!i.get(e.x,e.y-1)&&(f=new s.PathPoint(new r.Point(e.x,e.y-1),s.OrientationEnum.Left),h.push(f)),e.y+1<n.height&&n.facetMap.get(e.x,e.y+1)===a.id&&(e.x-1<0||n.facetMap.get(e.x-1,e.y+1)!==a.id)&&o.get(e.x,e.y+1)&&!i.get(e.x,e.y+1)&&(f=new s.PathPoint(new r.Point(e.x,e.y+1),s.OrientationEnum.Left),h.push(f)),e.y-1>=0&&e.x-1>=0&&n.facetMap.get(e.x-1,e.y-1)===a.id&&o.get(e.x-1,e.y-1)&&!c.get(e.x-1,e.y-1+1)&&!c.get(e.x,e.y)&&(f=new s.PathPoint(new r.Point(e.x-1,e.y-1),s.OrientationEnum.Bottom),h.push(f)),e.y+1<n.height&&e.x-1>=0&&n.facetMap.get(e.x-1,e.y+1)===a.id&&o.get(e.x-1,e.y+1)&&!c.get(e.x-1,e.y+1)&&!c.get(e.x,e.y+1)&&(f=new s.PathPoint(new r.Point(e.x-1,e.y+1),s.OrientationEnum.Top),h.push(f))}else e.orientation===s.OrientationEnum.Top?((e.x-1>=0&&n.facetMap.get(e.x-1,e.y)!==a.id||e.x-1<0)&&!i.get(e.x,e.y)&&(f=new s.PathPoint(new r.Point(e.x,e.y),s.OrientationEnum.Left),h.push(f)),(e.x+1<n.width&&n.facetMap.get(e.x+1,e.y)!==a.id||e.x+1>=n.width)&&!i.get(e.x+1,e.y)&&(f=new s.PathPoint(new r.Point(e.x,e.y),s.OrientationEnum.Right),h.push(f)),e.x-1>=0&&n.facetMap.get(e.x-1,e.y)===a.id&&(e.y-1<0||n.facetMap.get(e.x-1,e.y-1)!==a.id)&&o.get(e.x-1,e.y)&&!c.get(e.x-1,e.y)&&(f=new s.PathPoint(new r.Point(e.x-1,e.y),s.OrientationEnum.Top),h.push(f)),e.x+1<n.width&&n.facetMap.get(e.x+1,e.y)===a.id&&(e.y-1<0||n.facetMap.get(e.x+1,e.y-1)!==a.id)&&o.get(e.x+1,e.y)&&!c.get(e.x+1,e.y)&&(f=new s.PathPoint(new r.Point(e.x+1,e.y),s.OrientationEnum.Top),h.push(f)),e.y-1>=0&&e.x-1>=0&&n.facetMap.get(e.x-1,e.y-1)===a.id&&o.get(e.x-1,e.y-1)&&!i.get(e.x-1+1,e.y-1)&&!i.get(e.x,e.y)&&(f=new s.PathPoint(new r.Point(e.x-1,e.y-1),s.OrientationEnum.Right),h.push(f)),e.y-1>=0&&e.x+1<n.width&&n.facetMap.get(e.x+1,e.y-1)===a.id&&o.get(e.x+1,e.y-1)&&!i.get(e.x+1,e.y-1)&&!i.get(e.x+1,e.y)&&(f=new s.PathPoint(new r.Point(e.x+1,e.y-1),s.OrientationEnum.Left),h.push(f))):e.orientation===s.OrientationEnum.Right?((e.y-1>=0&&n.facetMap.get(e.x,e.y-1)!==a.id||e.y-1<0)&&!c.get(e.x,e.y)&&(f=new s.PathPoint(new r.Point(e.x,e.y),s.OrientationEnum.Top),h.push(f)),(e.y+1<n.height&&n.facetMap.get(e.x,e.y+1)!==a.id||e.y+1>=n.height)&&!c.get(e.x,e.y+1)&&(f=new s.PathPoint(new r.Point(e.x,e.y),s.OrientationEnum.Bottom),h.push(f)),e.y-1>=0&&n.facetMap.get(e.x,e.y-1)===a.id&&(e.x+1>=n.width||n.facetMap.get(e.x+1,e.y-1)!==a.id)&&o.get(e.x,e.y-1)&&!i.get(e.x+1,e.y-1)&&(f=new s.PathPoint(new r.Point(e.x,e.y-1),s.OrientationEnum.Right),h.push(f)),e.y+1<n.height&&n.facetMap.get(e.x,e.y+1)===a.id&&(e.x+1>=n.width||n.facetMap.get(e.x+1,e.y+1)!==a.id)&&o.get(e.x,e.y+1)&&!i.get(e.x+1,e.y+1)&&(f=new s.PathPoint(new r.Point(e.x,e.y+1),s.OrientationEnum.Right),h.push(f)),e.y-1>=0&&e.x+1<n.width&&n.facetMap.get(e.x+1,e.y-1)===a.id&&o.get(e.x+1,e.y-1)&&!c.get(e.x+1,e.y-1+1)&&!c.get(e.x,e.y)&&(f=new s.PathPoint(new r.Point(e.x+1,e.y-1),s.OrientationEnum.Bottom),h.push(f)),e.y+1<n.height&&e.x+1<n.width&&n.facetMap.get(e.x+1,e.y+1)===a.id&&o.get(e.x+1,e.y+1)&&!c.get(e.x+1,e.y+1)&&!c.get(e.x,e.y+1)&&(f=new s.PathPoint(new r.Point(e.x+1,e.y+1),s.OrientationEnum.Top),h.push(f))):e.orientation===s.OrientationEnum.Bottom&&((e.x-1>=0&&n.facetMap.get(e.x-1,e.y)!==a.id||e.x-1<0)&&!i.get(e.x,e.y)&&(f=new s.PathPoint(new r.Point(e.x,e.y),s.OrientationEnum.Left),h.push(f)),(e.x+1<n.width&&n.facetMap.get(e.x+1,e.y)!==a.id||e.x+1>=n.width)&&!i.get(e.x+1,e.y)&&(f=new s.PathPoint(new r.Point(e.x,e.y),s.OrientationEnum.Right),h.push(f)),e.x-1>=0&&n.facetMap.get(e.x-1,e.y)===a.id&&(e.y+1>=n.height||n.facetMap.get(e.x-1,e.y+1)!==a.id)&&o.get(e.x-1,e.y)&&!c.get(e.x-1,e.y+1)&&(f=new s.PathPoint(new r.Point(e.x-1,e.y),s.OrientationEnum.Bottom),h.push(f)),e.x+1<n.width&&n.facetMap.get(e.x+1,e.y)===a.id&&(e.y+1>=n.height||n.facetMap.get(e.x+1,e.y+1)!==a.id)&&o.get(e.x+1,e.y)&&!c.get(e.x+1,e.y+1)&&(f=new s.PathPoint(new r.Point(e.x+1,e.y),s.OrientationEnum.Bottom),h.push(f)),e.y+1<n.height&&e.x-1>=0&&n.facetMap.get(e.x-1,e.y+1)===a.id&&o.get(e.x-1,e.y+1)&&!i.get(e.x-1+1,e.y+1)&&!i.get(e.x,e.y)&&(f=new s.PathPoint(new r.Point(e.x-1,e.y+1),s.OrientationEnum.Right),h.push(f)),e.y+1<n.height&&e.x+1<n.width&&n.facetMap.get(e.x+1,e.y+1)===a.id&&o.get(e.x+1,e.y+1)&&!i.get(e.x+1,e.y+1)&&!i.get(e.x+1,e.y)&&(f=new s.PathPoint(new r.Point(e.x+1,e.y+1),s.OrientationEnum.Left),h.push(f)));h.length>1||1===h.length?(e=h[0],t.addPointToPath(l,e,i,a,c)):u=!0}for(var d=0,p=l;d<p.length;d++){var g=p[d];switch(g.orientation){case s.OrientationEnum.Left:i.set(g.x,g.y,!1);break;case s.OrientationEnum.Top:c.set(g.x,g.y,!1);break;case s.OrientationEnum.Right:i.set(g.x+1,g.y,!1);break;case s.OrientationEnum.Bottom:c.set(g.x,g.y+1,!1)}}return l},t.addPointToPath=function(t,e,n,r,a){switch(t.push(e),e.orientation){case s.OrientationEnum.Left:n.set(e.x,e.y,!0);break;case s.OrientationEnum.Top:a.set(e.x,e.y,!0);break;case s.OrientationEnum.Right:n.set(e.x+1,e.y,!0);break;case s.OrientationEnum.Bottom:a.set(e.x,e.y+1,!0)}},t}();e.FacetBorderTracer=c}.apply(e,r),void 0===a||(t.exports=a)},707:function(t,e,n){var r,a,o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(a,o){function i(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=e.call(t,i)}catch(t){o=[6,t],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};r=[n,e,n(200),n(206),n(891),n(946),n(297),n(144)],a=function(t,e,n,r,a,s,c,u){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FacetCreator=void 0;var l=function(){function t(){}return t.getFacets=function(e,r,a,s){return void 0===s&&(s=null),o(this,void 0,void 0,(function(){var o,l,h,f,d,p,g,y,v,b,m;return i(this,(function(i){switch(i.label){case 0:(o=new u.FacetResult).width=e,o.height=r,l=new c.BooleanArray2D(o.width,o.height),o.facetMap=new c.Uint32Array2D(o.width,o.height),o.facets=[],h=0,f=0,i.label=1;case 1:if(!(f<o.height))return[3,7];d=0,i.label=2;case 2:return d<o.width?(p=a.get(d,f),l.get(d,f)?[3,4]:(g=o.facets.length,y=t.buildFacet(g,p,d,f,l,a,o),o.facets.push(y),h%100!=0?[3,4]:[4,(0,n.delay)(0)])):[3,6];case 3:i.sent(),null!=s&&s(h/(o.width*o.height)),i.label=4;case 4:h++,i.label=5;case 5:return d++,[3,2];case 6:return f++,[3,1];case 7:return[4,(0,n.delay)(0)];case 8:for(i.sent(),v=0,b=o.facets;v<b.length;v++)null!=(m=b[v])&&t.buildFacetNeighbour(m,o);return null!=s&&s(1),[2,o]}}))}))},t.buildFacet=function(t,e,n,o,i,c,l){var h=new u.Facet;return h.id=t,h.color=e,h.bbox=new a.BoundingBox,h.borderPoints=[],h.neighbourFacetsIsDirty=!0,h.neighbourFacets=null,(0,r.fill)(n,o,l.width,l.height,(function(t,n){return i.get(t,n)||c.get(t,n)!==e}),(function(n,r){i.set(n,r,!0),l.facetMap.set(n,r,t),h.pointCount++,c.matchAllAround(n,r,e)||h.borderPoints.push(new s.Point(n,r)),n>h.bbox.maxX&&(h.bbox.maxX=n),r>h.bbox.maxY&&(h.bbox.maxY=r),n<h.bbox.minX&&(h.bbox.minX=n),r<h.bbox.minY&&(h.bbox.minY=r)})),h},t.buildFacetNeighbour=function(t,e){t.neighbourFacets=[];for(var n={},r=0,a=t.borderPoints;r<a.length;r++){var o=a[r];if(o.x-1>=0){var i=e.facetMap.get(o.x-1,o.y);i!==t.id&&(n[i]=!0)}if(o.y-1>=0){var s=e.facetMap.get(o.x,o.y-1);s!==t.id&&(n[s]=!0)}if(o.x+1<e.width){var c=e.facetMap.get(o.x+1,o.y);c!==t.id&&(n[c]=!0)}if(o.y+1<e.height){var u=e.facetMap.get(o.x,o.y+1);u!==t.id&&(n[u]=!0)}}for(var l=0,h=Object.keys(n);l<h.length;l++){var f=h[l];n.hasOwnProperty(f)&&t.neighbourFacets.push(parseInt(f))}t.neighbourFacetsIsDirty=!1},t}();e.FacetCreator=l}.apply(e,r),void 0===a||(t.exports=a)},59:function(t,e,n){var r,a,o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(a,o){function i(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=e.call(t,i)}catch(t){o=[6,t],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};r=[n,e,n(200),n(877),n(891),n(707)],a=function(t,e,n,r,a,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FacetLabelPlacer=void 0;var c=function(){function t(){}return t.buildFacetLabelBounds=function(e,c){return void 0===c&&(c=null),o(this,void 0,void 0,(function(){var o,u,l,h,f,d,p,g,y,v,b,m,w;return i(this,(function(i){switch(i.label){case 0:o=0,u=0,l=e.facets,i.label=1;case 1:if(!(u<l.length))return[3,5];if(null==(h=l[u]))return[3,3];for(f=[],d=h.getFullPathFromBorderSegments(!0),f.push(d),p=[d],h.neighbourFacetsIsDirty&&s.FacetCreator.buildFacetNeighbour(h,e),g=0,y=h.neighbourFacets;g<y.length;g++)v=y[g],b=e.facets[v].getFullPathFromBorderSegments(!0),t.doesNeighbourFallInsideInCurrentFacet(b,h,p)&&f.push(b);return m=(0,r.polylabel)(f),h.labelBounds=new a.BoundingBox,w=2*Math.sqrt(2*m.distance),h.labelBounds.minX=m.pt.x-w,h.labelBounds.maxX=m.pt.x+w,h.labelBounds.minY=m.pt.y-w,h.labelBounds.maxY=m.pt.y+w,o%100!=0?[3,3]:[4,(0,n.delay)(0)];case 2:i.sent(),null!=c&&c(h.id/e.facets.length),i.label=3;case 3:o++,i.label=4;case 4:return u++,[3,1];case 5:return null!=c&&c(1),[2]}}))}))},t.doesNeighbourFallInsideInCurrentFacet=function(t,e,n){for(var a=!0,o=0;o<t.length&&a;o++)t[o].x>=e.bbox.minX&&t[o].x<=e.bbox.maxX&&t[o].y>=e.bbox.minY&&t[o].y<=e.bbox.maxY||(a=!1);if(a)for(o=0;o<t.length&&a;o++)(0,r.pointToPolygonDist)(t[o].x,t[o].y,n)<0&&(a=!1);return a},t}();e.FacetLabelPlacer=c}.apply(e,r),void 0===a||(t.exports=a)},966:function(t,e,n){var r,a,o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(a,o){function i(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=e.call(t,i)}catch(t){o=[6,t],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};r=[n,e,n(571),n(200),n(707),n(297)],a=function(t,e,n,r,a,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FacetReducer=void 0;var c=function(){function t(){}return t.reduceFacets=function(e,a,c,u,l,h,f){return void 0===f&&(f=null),o(this,void 0,void 0,(function(){var o,d,p,g,y,v,b,m,w,x;return i(this,(function(i){switch(i.label){case 0:o=new s.BooleanArray2D(l.width,l.height),d=n.ColorReducer.buildColorDistanceMatrix(u),p=l.facets.filter((function(t){return null!=t})).slice(0).sort((function(t,e){return e.pointCount>t.pointCount?1:e.pointCount<t.pointCount?-1:0})).map((function(t){return t.id})),a||p.reverse(),g=(new Date).getTime(),y=0,i.label=1;case 1:return y<p.length?null!=(v=l.facets[p[y]])&&v.pointCount<e?(t.deleteFacet(v.id,l,h,d,o),(new Date).getTime()-g>500?(g=(new Date).getTime(),[4,(0,r.delay)(0)]):[3,3]):[3,3]:[3,4];case 2:i.sent(),null!=f&&f(.5*y/p.length),i.label=3;case 3:return y++,[3,1];case 4:b=l.facets.filter((function(t){return null!=t})).length,b>c&&console.log("There are still ".concat(b," facets, more than the maximum of ").concat(c,". Removing the smallest facets")),m=b,i.label=5;case 5:return b>c?(w=l.facets.filter((function(t){return null!=t})).slice(0).sort((function(t,e){return e.pointCount>t.pointCount?1:e.pointCount<t.pointCount?-1:0})).map((function(t){return t.id})).reverse(),x=l.facets[w[0]],t.deleteFacet(x.id,l,h,d,o),b=l.facets.filter((function(t){return null!=t})).length,(new Date).getTime()-g>500?(g=(new Date).getTime(),[4,(0,r.delay)(0)]):[3,7]):[3,8];case 6:i.sent(),null!=f&&f(1-(b-c)/(m-c)),i.label=7;case 7:return[3,5];case 8:return null!=f&&f(1),[2]}}))}))},t.deleteFacet=function(e,n,r,o,i){var s=n.facets[e];if(null!==s){if(s.neighbourFacetsIsDirty&&a.FacetCreator.buildFacetNeighbour(s,n),s.neighbourFacets.length>0){for(var c=s.bbox.minY;c<=s.bbox.maxY;c++)for(var u=s.bbox.minX;u<=s.bbox.maxX;u++)if(n.facetMap.get(u,c)===s.id){var l=t.getClosestNeighbourForPixel(s,n,u,c,o);-1!==l?r.set(u,c,n.facets[l].color):console.warn("No closest neighbour found for point ".concat(u,",").concat(c))}}else console.warn("Facet ".concat(s.id," does not have any neighbours"));t.rebuildForFacetChange(i,s,r,n),n.facets[s.id]=null}},t.rebuildForFacetChange=function(e,n,r,a){t.rebuildChangedNeighbourFacets(e,n,r,a);for(var o=!1,i=n.bbox.minY;i<=n.bbox.maxY;i++)for(var s=n.bbox.minX;s<=n.bbox.maxX;s++)a.facetMap.get(s,i)===n.id&&(console.warn("Point ".concat(s,",").concat(i," was reallocated to neighbours for facet ").concat(n.id)),o=!0,s-1>=0&&a.facetMap.get(s-1,i)!==n.id&&null!==a.facets[a.facetMap.get(s-1,i)]?r.set(s,i,a.facets[a.facetMap.get(s-1,i)].color):i-1>=0&&a.facetMap.get(s,i-1)!==n.id&&null!==a.facets[a.facetMap.get(s,i-1)]?r.set(s,i,a.facets[a.facetMap.get(s,i-1)].color):s+1<a.width&&a.facetMap.get(s+1,i)!==n.id&&null!==a.facets[a.facetMap.get(s+1,i)]?r.set(s,i,a.facets[a.facetMap.get(s+1,i)].color):i+1<a.height&&a.facetMap.get(s,i+1)!==n.id&&null!==a.facets[a.facetMap.get(s,i+1)]?r.set(s,i,a.facets[a.facetMap.get(s,i+1)].color):console.error("Unable to reallocate point ".concat(s,",").concat(i)));o&&t.rebuildChangedNeighbourFacets(e,n,r,a)},t.getClosestNeighbourForPixel=function(t,e,n,r,o){var i=-1,s=Number.MAX_VALUE,c=Number.MAX_VALUE;t.neighbourFacetsIsDirty&&a.FacetCreator.buildFacetNeighbour(t,e);for(var u=0,l=t.neighbourFacets;u<l.length;u++){var h=l[u],f=e.facets[h];if(null!=f)for(var d=0,p=f.borderPoints;d<p.length;d++){var g=p[d].distanceToCoord(n,r);if(g<s)s=g,i=h,c=Number.MAX_VALUE;else if(g===s){var y=o[t.color][f.color];y<c&&(c=y,i=h)}}}return i},t.rebuildChangedNeighbourFacets=function(t,e,n,r){var o={};e.neighbourFacetsIsDirty&&a.FacetCreator.buildFacetNeighbour(e,r);for(var i=0,s=e.neighbourFacets;i<s.length;i++){var c=s[i];if(null!=(p=r.facets[c])){o[c]=!0,p.neighbourFacetsIsDirty&&a.FacetCreator.buildFacetNeighbour(p,r);for(var u=0,l=p.neighbourFacets;u<l.length;u++)o[l[u]]=!0;var h=a.FacetCreator.buildFacet(c,p.color,p.borderPoints[0].x,p.borderPoints[0].y,t,n,r);r.facets[c]=h,0===h.pointCount&&(r.facets[c]=null)}}e.neighbourFacetsIsDirty&&a.FacetCreator.buildFacetNeighbour(e,r);for(var f=0,d=e.neighbourFacets;f<d.length;f++){var p;if(c=d[f],null!=(p=r.facets[c]))for(var g=p.bbox.minY;g<=p.bbox.maxY;g++)for(var y=p.bbox.minX;y<=p.bbox.maxX;y++)r.facetMap.get(y,g)===p.id&&t.set(y,g,!1)}for(var v=0,b=Object.keys(o);v<b.length;v++){var m=b[v];if(o.hasOwnProperty(m)){c=parseInt(m);var w=r.facets[c];null!=w&&(w.neighbourFacets=null,w.neighbourFacetsIsDirty=!0)}}},t}();e.FacetReducer=c}.apply(e,r),void 0===a||(t.exports=a)},144:function(t,e,n){var r,a,o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});r=[n,e,n(946)],a=function(t,e,n){"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0}),e.FacetResult=e.Facet=e.PathPoint=e.OrientationEnum=void 0,function(t){t[t.Left=0]="Left",t[t.Top=1]="Top",t[t.Right=2]="Right",t[t.Bottom=3]="Bottom"}(r=e.OrientationEnum||(e.OrientationEnum={}));var a=function(t){function e(e,n){var r=t.call(this,e.x,e.y)||this;return r.orientation=n,r}return i(e,t),e.prototype.getWallX=function(){var t=this.x;return this.orientation===r.Left?t-=.5:this.orientation===r.Right&&(t+=.5),t},e.prototype.getWallY=function(){var t=this.y;return this.orientation===r.Top?t-=.5:this.orientation===r.Bottom&&(t+=.5),t},e.prototype.getNeighbour=function(t){switch(this.orientation){case r.Left:if(this.x-1>=0)return t.facetMap.get(this.x-1,this.y);break;case r.Right:if(this.x+1<t.width)return t.facetMap.get(this.x+1,this.y);break;case r.Top:if(this.y-1>=0)return t.facetMap.get(this.x,this.y-1);break;case r.Bottom:if(this.y+1<t.height)return t.facetMap.get(this.x,this.y+1)}return-1},e.prototype.toString=function(){return this.x+","+this.y+" "+this.orientation},e}(n.Point);e.PathPoint=a;var o=function(){function t(){this.pointCount=0,this.neighbourFacetsIsDirty=!1}return t.prototype.getFullPathFromBorderSegments=function(t){for(var e=[],r=function(r){t?e.push(new n.Point(r.getWallX(),r.getWallY())):e.push(new n.Point(r.x,r.y))},a=null,o=0,i=this.borderSegments;o<i.length;o++){var s=i[o];null!=a&&(a.reverseOrder?r(a.originalSegment.points[0]):r(a.originalSegment.points[a.originalSegment.points.length-1]));for(var c=0;c<s.originalSegment.points.length;c++){var u=s.reverseOrder?s.originalSegment.points.length-1-c:c;r(s.originalSegment.points[u])}a=s}return e},t}();e.Facet=o;e.FacetResult=function(){}}.apply(e,r),void 0===a||(t.exports=a)},906:function(t,e,n){var r,a,o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(a,o){function i(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=e.call(t,i)}catch(t){o=[6,t],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};r=[n,e,n(200),n(646),n(310)],a=function(t,e,n,r,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.loadExample=e.downloadSVG=e.downloadPNG=e.downloadPalettePng=e.updateOutput=e.process=e.parseSettings=e.log=e.timeEnd=e.time=void 0;var s=null,c=new n.CancellationToken,u={};function l(t){$("#log").append("<br/><span>"+t+"</span>")}function h(){var t=new a.Settings;$("#optColorSpaceRGB").prop("checked")?t.kMeansClusteringColorSpace=a.ClusteringColorSpace.RGB:$("#optColorSpaceHSL").prop("checked")?t.kMeansClusteringColorSpace=a.ClusteringColorSpace.HSL:$("#optColorSpaceRGB").prop("checked")&&(t.kMeansClusteringColorSpace=a.ClusteringColorSpace.LAB),$("#optFacetRemovalLargestToSmallest").prop("checked")?t.removeFacetsFromLargeToSmall=!0:t.removeFacetsFromLargeToSmall=!1,t.randomSeed=parseInt($("#txtRandomSeed").val()+""),t.kMeansNrOfClusters=parseInt($("#txtNrOfClusters").val()+""),t.kMeansMinDeltaDifference=parseFloat($("#txtClusterPrecision").val()+""),t.removeFacetsSmallerThanNrOfPoints=parseInt($("#txtRemoveFacetsSmallerThan").val()+""),t.maximumNumberOfFacets=parseInt($("#txtMaximumNumberOfFacets").val()+""),t.nrOfTimesToHalveBorderSegments=parseInt($("#txtNrOfTimesToHalveBorderSegments").val()+""),t.narrowPixelStripCleanupRuns=parseInt($("#txtNarrowPixelStripCleanupRuns").val()+""),t.resizeImageIfTooLarge=$("#chkResizeImage").prop("checked"),t.resizeImageWidth=parseInt($("#txtResizeWidth").val()+""),t.resizeImageHeight=parseInt($("#txtResizeHeight").val()+"");for(var e=0,n=($("#txtKMeansColorRestrictions").val()+"").split("\n");e<n.length;e++){var r=n[e].trim();if(0===r.indexOf("//"));else{var o=r.split(",");if(3===o.length){var i=parseInt(o[0]),s=parseInt(o[1]),c=parseInt(o[2]);i<0&&(i=0),i>255&&(i=255),s<0&&(s=0),s>255&&(s=255),c<0&&(c=0),c>255&&(c=255),isNaN(i)||isNaN(s)||isNaN(c)||t.kMeansColorRestrictions.push([i,s,c])}}}return t}function f(){return o(this,void 0,void 0,(function(){var t,e,n,a,o,u,l;return i(this,(function(i){switch(i.label){case 0:return null==s?[3,2]:(t=$("#chkShowLabels").prop("checked"),e=$("#chkFillFacets").prop("checked"),n=$("#chkShowBorders").prop("checked"),a=parseInt($("#txtSizeMultiplier").val()+""),o=parseInt($("#txtLabelFontSize").val()+""),u=$("#txtLabelFontColor").val()+"",$("#statusSVGGenerate").css("width","0%"),$(".status.SVGGenerate").removeClass("complete"),$(".status.SVGGenerate").addClass("active"),[4,r.GUIProcessManager.createSVG(s.facetResult,s.colorsByIndex,a,e,n,t,o,u,(function(t){if(c.isCancelled)throw new Error("Cancelled");$("#statusSVGGenerate").css("width",Math.round(100*t)+"%")}))]);case 1:l=i.sent(),$("#svgContainer").empty().append(l),$("#palette").empty().append(function(t){for(var e="",n=0;n<t.length;n++){var r="background-color: "+"rgb(".concat(t[n][0],",").concat(t[n][1],",").concat(t[n][2],")");e+='<div class="color" class="tooltipped" style="'.concat(r,'" data-tooltip="').concat(t[n][0],",").concat(t[n][1],",").concat(t[n][2],'">').concat(n,"</div>")}return $(e)}(s.colorsByIndex)),$("#palette .color").tooltip(),$(".status").removeClass("active"),$(".status.SVGGenerate").addClass("complete"),i.label=2;case 2:return[2]}}))}))}e.time=function(t){console.time(t),u[t]=new Date},e.timeEnd=function(t){console.timeEnd(t),l(t+": "+((new Date).getTime()-u[t].getTime())+"ms"),delete u[t]},e.log=l,e.parseSettings=h,e.process=function(){return o(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),t=h(),c.isCancelled=!0,c=new n.CancellationToken,[4,r.GUIProcessManager.process(t,c)];case 1:return s=e.sent(),[4,f()];case 2:return e.sent(),M.Tabs.getInstance(document.getElementById("tabsOutput")).select("output-pane"),[3,4];case 3:return e.sent(),l("Error: "),[3,4];case 4:return[2]}}))}))},e.updateOutput=f,e.downloadPalettePng=function(){if(null!=s){var t=s.colorsByIndex,e=document.createElement("canvas"),n=Math.ceil(t.length/10);e.width=910,e.height=10+80*n;var r=e.getContext("2d");r.translate(.5,.5),r.fillStyle="white",r.fillRect(0,0,e.width,e.height);for(var a=0;a<t.length;a++){var o=t[a],i=10+a%10*90,c=10+80*Math.floor(a/10);r.fillStyle="rgb(".concat(o[0],", ").concat(o[1],", ").concat(o[2],")"),r.fillRect(i,c,80,50),r.strokeStyle="#888",r.strokeRect(i,c,80,50);var u=a+"";r.fillStyle="black",r.strokeStyle="#CCC",r.font="20px Tahoma";var l=r.measureText(u);r.lineWidth=2,r.strokeText(u,i+40-l.width/2,c+35-5),r.fillText(u,i+40-l.width/2,c+35-5),r.lineWidth=1,r.font="10px Tahoma";var h="RGB: "+Math.floor(o[0])+","+Math.floor(o[1])+","+Math.floor(o[2]),f=r.measureText(h);r.fillStyle="black",r.fillText(h,i+40-f.width/2,c+70-10)}var d=e.toDataURL("image/png"),p=document.createElement("a");document.body.appendChild(p),p.setAttribute("href",d),p.setAttribute("download","palette.png"),p.click()}},e.downloadPNG=function(){$("#svgContainer svg").length>0&&saveSvgAsPng($("#svgContainer svg").get(0),"paintbynumbers.png")},e.downloadSVG=function(){if($("#svgContainer svg").length>0){var t=$("#svgContainer svg").get(0);t.setAttribute("xmlns","http://www.w3.org/2000/svg");var e=t.outerHTML,n=new Blob(['<?xml version="1.0" standalone="no"?>\r\n',e],{type:"image/svg+xml;charset=utf-8"}),r=URL.createObjectURL(n),a=document.createElement("a");a.href=r,a.download="paintbynumbers.svg",document.body.appendChild(a),a.click(),document.body.removeChild(a)}},e.loadExample=function(t){var e=document.getElementById(t),n=document.getElementById("canvas"),r=n.getContext("2d");n.width=e.naturalWidth,n.height=e.naturalHeight,r.drawImage(e,0,0)}}.apply(e,r),void 0===a||(t.exports=a)},646:function(t,e,n){var r,a,o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(a,o){function i(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=e.call(t,i)}catch(t){o=[6,t],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};r=[n,e,n(571),n(200),n(783),n(194),n(707),n(59),n(144),n(966),n(906),n(946)],a=function(t,e,n,r,a,s,c,u,l,h,f,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GUIProcessManager=e.ProcessResult=void 0;var p=function(){};e.ProcessResult=p;var g=function(){function t(){}return t.process=function(e,r){return o(this,void 0,void 0,(function(){var a,o,s,c,u,h,f,d,g,y,v,b,m,w,x;return i(this,(function(i){switch(i.label){case 0:return a=document.getElementById("canvas"),o=a.getContext("2d"),s=o.getImageData(0,0,a.width,a.height),e.resizeImageIfTooLarge&&(a.width>e.resizeImageWidth||a.height>e.resizeImageHeight)&&(c=a.width,u=a.height,c>e.resizeImageWidth&&(f=e.resizeImageWidth,h=a.height/a.width*e.resizeImageWidth,c=f,u=h),u>e.resizeImageHeight&&(h=e.resizeImageHeight,c=f=c/u*h,u=h),(d=document.createElement("canvas")).width=c,d.height=u,d.getContext("2d").drawImage(a,0,0,c,u),a.width=c,a.height=u,o.drawImage(d,0,0,c,u),s=o.getImageData(0,0,a.width,a.height)),$(".status .progress .determinate").css("width","0px"),$(".status").removeClass("complete"),g=M.Tabs.getInstance(document.getElementById("tabsOutput")),[4,t.processKmeansClustering(s,g,o,e,r)];case 1:return y=i.sent(),v=new l.FacetResult,b=new n.ColorMapResult,b=n.ColorReducer.createColorMap(y),0!==e.narrowPixelStripCleanupRuns?[3,4]:[4,t.processFacetBuilding(b,r)];case 2:return v=i.sent(),[4,t.processFacetReduction(v,g,e,b,r)];case 3:return i.sent(),[3,10];case 4:m=0,i.label=5;case 5:return m<e.narrowPixelStripCleanupRuns?[4,n.ColorReducer.processNarrowPixelStripCleanup(b)]:[3,10];case 6:return i.sent(),[4,t.processFacetBuilding(b,r)];case 7:return v=i.sent(),[4,t.processFacetReduction(v,g,e,b,r)];case 8:i.sent(),i.label=9;case 9:return m++,[3,5];case 10:return[4,t.processFacetBorderTracing(g,v,r)];case 11:return i.sent(),[4,t.processFacetBorderSegmentation(v,g,e,r)];case 12:return w=i.sent(),[4,t.processFacetLabelPlacement(v,w,g,r)];case 13:return i.sent(),(x=new p).facetResult=v,x.colorsByIndex=b.colorsByIndex,[2,x]}}))}))},t.processKmeansClustering=function(t,e,r,a,s){return o(this,void 0,void 0,(function(){var o,c,u;return i(this,(function(i){switch(i.label){case 0:return(0,f.time)("K-means clustering"),(o=document.getElementById("cKMeans")).width=t.width,o.height=t.height,(c=o.getContext("2d")).fillStyle="white",c.fillRect(0,0,o.width,o.height),u=c.getImageData(0,0,o.width,o.height),e.select("kmeans-pane"),$(".status.kMeans").addClass("active"),[4,n.ColorReducer.applyKMeansClustering(t,u,r,a,(function(t){var e=(100-(t.currentDeltaDistanceDifference>100?100:t.currentDeltaDistanceDifference))/100;if($("#statusKMeans").css("width",Math.round(100*e)+"%"),c.putImageData(u,0,0),console.log(t.currentDeltaDistanceDifference),s.isCancelled)throw new Error("Cancelled")}))];case 1:return i.sent(),$(".status").removeClass("active"),$(".status.kMeans").addClass("complete"),(0,f.timeEnd)("K-means clustering"),[2,u]}}))}))},t.processFacetBuilding=function(t,e){return o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return(0,f.time)("Facet building"),$(".status.facetBuilding").addClass("active"),[4,c.FacetCreator.getFacets(t.width,t.height,t.imgColorIndices,(function(t){if(e.isCancelled)throw new Error("Cancelled");$("#statusFacetBuilding").css("width",Math.round(100*t)+"%")}))];case 1:return n=r.sent(),$(".status").removeClass("active"),$(".status.facetBuilding").addClass("complete"),(0,f.timeEnd)("Facet building"),[2,n]}}))}))},t.processFacetReduction=function(t,e,n,r,a){return o(this,void 0,void 0,(function(){var o,s,c;return i(this,(function(i){switch(i.label){case 0:return(0,f.time)("Facet reduction"),(o=document.getElementById("cReduction")).width=t.width,o.height=t.height,(s=o.getContext("2d")).fillStyle="white",s.fillRect(0,0,o.width,o.height),c=s.getImageData(0,0,o.width,o.height),e.select("reduction-pane"),$(".status.facetReduction").addClass("active"),[4,h.FacetReducer.reduceFacets(n.removeFacetsSmallerThanNrOfPoints,n.removeFacetsFromLargeToSmall,n.maximumNumberOfFacets,r.colorsByIndex,t,r.imgColorIndices,(function(e){if(a.isCancelled)throw new Error("Cancelled");$("#statusFacetReduction").css("width",Math.round(100*e)+"%");for(var n=0,o=0;o<t.height;o++)for(var i=0;i<t.width;i++){var u=t.facets[t.facetMap.get(i,o)],l=r.colorsByIndex[u.color];c.data[n++]=l[0],c.data[n++]=l[1],c.data[n++]=l[2],n++}s.putImageData(c,0,0)}))];case 1:return i.sent(),$(".status").removeClass("active"),$(".status.facetReduction").addClass("complete"),(0,f.timeEnd)("Facet reduction"),[2]}}))}))},t.processFacetBorderTracing=function(t,e,n){return o(this,void 0,void 0,(function(){var r,a;return i(this,(function(o){switch(o.label){case 0:return(0,f.time)("Facet border tracing"),t.select("borderpath-pane"),(r=document.getElementById("cBorderPath")).width=e.width,r.height=e.height,a=r.getContext("2d"),$(".status.facetBorderPath").addClass("active"),[4,s.FacetBorderTracer.buildFacetBorderPaths(e,(function(t){if(n.isCancelled)throw new Error("Cancelled");$("#statusFacetBorderPath").css("width",Math.round(100*t)+"%"),a.fillStyle="white",a.fillRect(0,0,r.width,r.height);for(var o=0,i=e.facets;o<i.length;o++){var s=i[o];if(null!=s&&null!=s.borderPath){a.beginPath(),a.moveTo(s.borderPath[0].getWallX(),s.borderPath[0].getWallY());for(var c=1;c<s.borderPath.length;c++)a.lineTo(s.borderPath[c].getWallX(),s.borderPath[c].getWallY());a.stroke()}}}))];case 1:return o.sent(),$(".status").removeClass("active"),$(".status.facetBorderPath").addClass("complete"),(0,f.timeEnd)("Facet border tracing"),[2]}}))}))},t.processFacetBorderSegmentation=function(t,e,n,r){return o(this,void 0,void 0,(function(){var o,s;return i(this,(function(i){switch(i.label){case 0:return(0,f.time)("Facet border segmentation"),(o=document.getElementById("cBorderSegmentation")).width=t.width,o.height=t.height,s=o.getContext("2d"),e.select("bordersegmentation-pane"),$(".status.facetBorderSegmentation").addClass("active"),[4,a.FacetBorderSegmenter.buildFacetBorderSegments(t,n.nrOfTimesToHalveBorderSegments,(function(e){if(r.isCancelled)throw new Error("Cancelled");$("#statusFacetBorderSegmentation").css("width",Math.round(100*e)+"%"),s.fillStyle="white",s.fillRect(0,0,o.width,o.height);for(var n=0,a=t.facets;n<a.length;n++){var i=a[n];if(null!=i&&e>i.id/t.facets.length){s.beginPath();var c=i.getFullPathFromBorderSegments(!1);s.moveTo(c[0].x,c[0].y);for(var u=1;u<c.length;u++)s.lineTo(c[u].x,c[u].y);s.stroke()}}}))];case 1:return i.sent(),$(".status").removeClass("active"),$(".status.facetBorderSegmentation").addClass("complete"),(0,f.timeEnd)("Facet border segmentation"),[2,o]}}))}))},t.processFacetLabelPlacement=function(t,e,n,r){return o(this,void 0,void 0,(function(){var a,o;return i(this,(function(i){switch(i.label){case 0:return(0,f.time)("Facet label placement"),(a=document.getElementById("cLabelPlacement")).width=t.width,a.height=t.height,(o=a.getContext("2d")).fillStyle="white",o.fillRect(0,0,e.width,e.height),o.drawImage(e,0,0),n.select("labelplacement-pane"),$(".status.facetLabelPlacement").addClass("active"),[4,u.FacetLabelPlacer.buildFacetLabelBounds(t,(function(e){if(r.isCancelled)throw new Error("Cancelled");$("#statusFacetLabelPlacement").css("width",Math.round(100*e)+"%");for(var n=0,a=t.facets;n<a.length;n++){var i=a[n];null!=i&&null!=i.labelBounds&&(o.fillStyle="red",o.fillRect(i.labelBounds.minX,i.labelBounds.minY,i.labelBounds.width,i.labelBounds.height))}}))];case 1:return i.sent(),$(".status").removeClass("active"),$(".status.facetLabelPlacement").addClass("complete"),(0,f.timeEnd)("Facet label placement"),[2]}}))}))},t.createSVG=function(t,e,n,a,s,c,u,l,h){return void 0===u&&(u=50),void 0===l&&(l="black"),void 0===h&&(h=null),o(this,void 0,void 0,(function(){var o,f,d,p,g,y,v,b,m,w,x,P,C,M,S,k;return i(this,(function(i){switch(i.label){case 0:o="http://www.w3.org/2000/svg",(f=document.createElementNS(o,"svg")).setAttribute("width",n*t.width+""),f.setAttribute("height",n*t.height+""),d=0,p=0,g=t.facets,i.label=1;case 1:if(!(p<g.length))return[3,5];if(!(null!=(y=g[p])&&y.borderSegments.length>0))return[3,3];for(v=[],(v=y.getFullPathFromBorderSegments(!1))[0].x===v[v.length-1].x&&v[0].y===v[v.length-1].y||v.push(v[0]),b=document.createElementNS("http://www.w3.org/2000/svg","path"),m="M ",m+=v[0].x*n+" "+v[0].y*n+" ",w=1;w<v.length;w++)x=(v[w].x+v[w-1].x)/2,P=(v[w].y+v[w-1].y)/2,m+="Q "+x*n+" "+P*n+" "+v[w].x*n+" "+v[w].y*n+" ";return m+="Z",b.setAttribute("data-facetId",y.id+""),b.setAttribute("d",m),s?b.style.stroke="#000":a&&(b.style.stroke="rgb(".concat(e[y.color][0],",").concat(e[y.color][1],",").concat(e[y.color][2],")")),b.style.strokeWidth="1px",b.style.fill=a?"rgb(".concat(e[y.color][0],",").concat(e[y.color][1],",").concat(e[y.color][2],")"):"none",f.appendChild(b),c&&((C=document.createElementNS(o,"text")).setAttribute("font-family","Tahoma"),M=(y.color+"").length,C.setAttribute("font-size",u/M+""),C.setAttribute("dominant-baseline","middle"),C.setAttribute("text-anchor","middle"),C.setAttribute("fill",l),C.textContent=y.color+"",(S=document.createElementNS(o,"svg")).setAttribute("width",y.labelBounds.width*n+""),S.setAttribute("height",y.labelBounds.height*n+""),S.setAttribute("overflow","visible"),S.setAttribute("viewBox","-50 -50 100 100"),S.setAttribute("preserveAspectRatio","xMidYMid meet"),S.appendChild(C),(k=document.createElementNS(o,"g")).setAttribute("class","label"),k.setAttribute("transform","translate("+y.labelBounds.minX*n+","+y.labelBounds.minY*n+")"),k.appendChild(S),f.appendChild(k)),d%100!=0?[3,3]:[4,(0,r.delay)(0)];case 2:i.sent(),null!=h&&h(y.id/t.facets.length),i.label=3;case 3:d++,i.label=4;case 4:return p++,[3,1];case 5:return null!=h&&h(1),[2,f]}}))}))},t}();e.GUIProcessManager=g}.apply(e,r),void 0===a||(t.exports=a)},678:(t,e,n)=>{var r;r=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Clipboard=void 0;var n=function(){function t(t,e){this.ctrl_pressed=!1,this.command_pressed=!1,this.paste_event_support=!1;var n=this;this.canvas=document.getElementById(t),this.ctx=this.canvas.getContext("2d"),this.autoresize=e,document.addEventListener("paste",(function(t){n.paste_auto(t)}),!1),this.init()}return t.prototype.init=function(){this.pasteCatcher=document.createElement("div"),this.pasteCatcher.setAttribute("id","paste_ff"),this.pasteCatcher.setAttribute("contenteditable",""),this.pasteCatcher.style.cssText="opacity:0;position:fixed;top:0px;left:0px;width:10px;margin-left:-20px;",document.body.appendChild(this.pasteCatcher);var t=this,e=new MutationObserver((function(e){e.forEach((function(e){return!0===t.paste_event_support||!1===t.ctrl_pressed||"childList"!==e.type||(1===e.addedNodes.length&&(void 0!==e.addedNodes[0].src&&t.paste_createImage(e.addedNodes[0].src),setTimeout((function(){t.pasteCatcher.innerHTML=""}),20)),!1)}))})),n=document.getElementById("paste_ff");e.observe(n,{attributes:!0,childList:!0,characterData:!0})},t.prototype.paste_auto=function(t){if(this.paste_event_support=!1,void 0!==this.pasteCatcher&&(this.pasteCatcher.innerHTML=""),t.clipboardData){var e=t.clipboardData.items;if(e){this.paste_event_support=!0;for(var n=0;n<e.length;n++)if(-1!==e[n].type.indexOf("image")){var r=e[n].getAsFile(),a=(window.URL||window.webkitURL).createObjectURL(r);return this.paste_createImage(a),t.preventDefault(),!1}}}return!0},t.prototype.on_keyboard_action=function(t){var e=t.keyCode;if((17===e||t.metaKey||t.ctrlKey)&&!1===this.ctrl_pressed&&(this.ctrl_pressed=!0),86===e){if(void 0!==document.activeElement&&"text"===document.activeElement.type)return!1;!0===this.ctrl_pressed&&void 0!==this.pasteCatcher&&this.pasteCatcher.focus()}return!0},t.prototype.on_keyboardup_action=function(t){!1===t.ctrlKey&&!0===this.ctrl_pressed?this.ctrl_pressed=!1:!1===t.metaKey&&!0===this.command_pressed&&(this.command_pressed=!1,this.ctrl_pressed=!1)},t.prototype.paste_createImage=function(t){var e=new Image,n=this;e.onload=function(){!0===n.autoresize?(n.canvas.width=e.width,n.canvas.height=e.height):n.ctx.clearRect(0,0,n.canvas.width,n.canvas.height),n.ctx.drawImage(e,0,0)},e.src=t},t}();e.Clipboard=n}.apply(e,[n,e]),void 0===r||(t.exports=r)},749:(t,e,n)=>{var r;r=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.KMeans=e.Vector=void 0;var n=function(){function t(t,e){void 0===e&&(e=1),this.values=t,this.weight=e}return t.prototype.distanceTo=function(t){for(var e=0,n=0;n<this.values.length;n++)e+=(t.values[n]-this.values[n])*(t.values[n]-this.values[n]);return Math.sqrt(e)},t.average=function(e){if(0===e.length)throw Error("Can't average 0 elements");for(var n=e[0].values.length,r=[],a=0;a<n;a++)r.push(0);for(var o=0,i=0,s=e;i<s.length;i++){var c=s[i];for(o+=c.weight,a=0;a<n;a++)r[a]+=c.weight*c.values[a]}for(a=0;a<r.length;a++)r[a]/=o;return new t(r)},t}();e.Vector=n;var r=function(){function t(t,e,n,r){if(void 0===r&&(r=null),this.points=t,this.k=e,this.random=n,this.currentIteration=0,this.pointsPerCategory=[],this.centroids=[],this.currentDeltaDistanceDifference=0,null!=r){this.centroids=r;for(var a=0;a<this.k;a++)this.pointsPerCategory.push([])}else this.initCentroids()}return t.prototype.initCentroids=function(){for(var t=0;t<this.k;t++)this.centroids.push(this.points[Math.floor(this.points.length*this.random.next())]),this.pointsPerCategory.push([])},t.prototype.step=function(){for(var t=0;t<this.k;t++)this.pointsPerCategory[t]=[];for(var e=0,r=this.points;e<r.length;e++){for(var a=r[e],o=Number.MAX_VALUE,i=-1,s=0;s<this.k;s++)(l=this.centroids[s].distanceTo(a))<o&&(i=s,o=l);this.pointsPerCategory[i].push(a)}var c=0;for(s=0;s<this.pointsPerCategory.length;s++){var u=this.pointsPerCategory[s];if(u.length>0){var l,h=n.average(u);c+=l=this.centroids[s].distanceTo(h),this.centroids[s]=h}}this.currentDeltaDistanceDifference=c,this.currentIteration++},t}();e.KMeans=r}.apply(e,[n,e]),void 0===r||(t.exports=r)},159:(t,e,n)=>{var r;r=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.rgb2lab=e.lab2rgb=e.hslToRgb=e.rgbToHsl=void 0,e.rgbToHsl=function(t,e,n){t/=255,e/=255,n/=255;var r,a,o=Math.max(t,e,n),i=Math.min(t,e,n),s=(o+i)/2;if(o===i)r=a=0;else{var c=o-i;switch(a=s>.5?c/(2-o-i):c/(o+i),o){case t:r=(e-n)/c+(e<n?6:0);break;case e:r=(n-t)/c+2;break;case n:r=(t-e)/c+4;break;default:r=0}r/=6}return[r,a,s]},e.hslToRgb=function(t,e,n){var r,a,o;if(0===e)r=a=o=n;else{var i=function(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t},s=n<.5?n*(1+e):n+e-n*e,c=2*n-s;r=i(c,s,t+1/3),a=i(c,s,t),o=i(c,s,t-1/3)}return[255*r,255*a,255*o]},e.lab2rgb=function(t){var e,n,r,a=(t[0]+16)/116,o=t[1]/500+a,i=a-t[2]/200;return n=-.9689*(o=.95047*(o*o*o>.008856?o*o*o:(o-16/116)/7.787))+1.8758*(a=1*(a*a*a>.008856?a*a*a:(a-16/116)/7.787))+.0415*(i=1.08883*(i*i*i>.008856?i*i*i:(i-16/116)/7.787)),r=.0557*o+-.204*a+1.057*i,e=(e=3.2406*o+-1.5372*a+-.4986*i)>.0031308?1.055*Math.pow(e,1/2.4)-.055:12.92*e,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,[255*Math.max(0,Math.min(1,e)),255*Math.max(0,Math.min(1,n)),255*Math.max(0,Math.min(1,r))]},e.rgb2lab=function(t){var e,n,r,a=t[0]/255,o=t[1]/255,i=t[2]/255;return n=(.2126*(a=a>.04045?Math.pow((a+.055)/1.055,2.4):a/12.92)+.7152*(o=o>.04045?Math.pow((o+.055)/1.055,2.4):o/12.92)+.0722*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92))/1,r=(.0193*a+.1192*o+.9505*i)/1.08883,e=(e=(.4124*a+.3576*o+.1805*i)/.95047)>.008856?Math.pow(e,1/3):7.787*e+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(e-n),200*(n-(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116))]}}.apply(e,[n,e]),void 0===r||(t.exports=r)},815:(t,e,n)=>{var r;r=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PriorityQueue=e.Map=void 0;var n=function(){function t(){this.obj={}}return t.prototype.containsKey=function(t){return t in this.obj},t.prototype.getKeys=function(){var t=[];for(var e in this.obj)this.obj.hasOwnProperty(e)&&t.push(e);return t},t.prototype.get=function(t){var e=this.obj[t];return void 0===e?null:e},t.prototype.put=function(t,e){this.obj[t]=e},t.prototype.remove=function(t){delete this.obj[t]},t.prototype.clone=function(){var e=new t;for(var n in e.obj={},this.obj)e.obj[n]=this.obj[n];return e},t}();e.Map=n;var r=function(){function t(){this.array=[],this.keyMap=new n}return t.prototype.add=function(t){if(this.keyMap.containsKey(t.getKey()))throw new Error("Item with key "+t.getKey()+" already exists in the heap");this.array.push(t),this.keyMap.put(t.getKey(),this.array.length-1),this.checkParentRequirement(this.array.length-1)},t.prototype.replaceAt=function(t,e){this.array[t]=e,this.keyMap.put(e.getKey(),t),this.checkParentRequirement(t),this.checkChildrenRequirement(t)},t.prototype.shift=function(){return this.removeAt(0)},t.prototype.remove=function(t){var e=this.keyMap.get(t.getKey());-1!==e&&this.removeAt(e)},t.prototype.removeWhere=function(t){for(var e=[],n=this.array.length-1;n>=0;n--)t(this.array[n])&&e.push(this.array[n]);for(var r=0,a=e;r<a.length;r++){var o=a[r];this.remove(o)}for(var i=0,s=this.array;i<s.length;i++)if(t(o=s[i]))throw console.log("Idx of element not removed: "+this.keyMap.get(o.getKey())),new Error("element not removed: "+o.getKey())},t.prototype.removeAt=function(t){var e=this.array[t];this.keyMap.remove(e.getKey());var n=t===this.array.length-1;if(this.array.length>0){var r=this.array.pop();!n&&this.array.length>0&&this.replaceAt(t,r)}return e},t.prototype.foreach=function(t){for(var e=0,n=this.array.sort((function(t,e){return t.compareTo(e)}));e<n.length;e++)t(n[e])},t.prototype.peek=function(){return this.array[0]},t.prototype.contains=function(t){return this.keyMap.containsKey(t)},t.prototype.at=function(t){var e=this.keyMap.get(t);return void 0===e?null:this.array[e]},t.prototype.size=function(){return this.array.length},t.prototype.checkHeapRequirement=function(t){var e=this.keyMap.get(t.getKey());null!=e&&(this.checkParentRequirement(e),this.checkChildrenRequirement(e))},t.prototype.checkChildrenRequirement=function(t){for(var e=!1;!e;){var n=this.getLeftChildIndex(t),r=-1===n?-1:n+1;if(-1===n)return;r>=this.size()&&(r=-1);var a;a=-1===r||this.array[n].compareTo(this.array[r])<0?n:r,this.array[t].compareTo(this.array[a])>0?(this.swap(t,a),t=a):e=!0}},t.prototype.checkParentRequirement=function(e){for(var n=e,r=t.getParentIndex(n);r>=0&&this.array[r].compareTo(this.array[n])>0;)this.swap(n,r),n=r,r=t.getParentIndex(n)},t.prototype.dump=function(){0!==this.size()&&(this.getLeftChildIndex(0),console.log(this.array),console.log("--- keymap ---"),console.log(this.keyMap))},t.prototype.swap=function(t,e){this.keyMap.put(this.array[t].getKey(),e),this.keyMap.put(this.array[e].getKey(),t);var n=this.array[t];this.array[t]=this.array[e],this.array[e]=n},t.prototype.getLeftChildIndex=function(t){var e=2*(t+1)-1;return e>=this.array.length?-1:e},t.getParentIndex=function(t){return 0===t?-1:Math.floor((t+1)/2)-1},t.prototype.clone=function(){var e=new t;return e.array=this.array.slice(0),e.keyMap=this.keyMap.clone(),e},t}(),a=function(){function t(){this.heap=new r}return t.prototype.enqueue=function(t){this.heap.add(t)},t.prototype.peek=function(){return this.heap.peek()},t.prototype.updatePriority=function(t){this.heap.checkHeapRequirement(t)},t.prototype.get=function(t){return this.heap.at(t)},Object.defineProperty(t.prototype,"size",{get:function(){return this.heap.size()},enumerable:!1,configurable:!0}),t.prototype.dequeue=function(){return this.heap.shift()},t.prototype.dump=function(){this.heap.dump()},t.prototype.contains=function(t){return this.heap.contains(t)},t.prototype.removeWhere=function(t){this.heap.removeWhere(t)},t.prototype.foreach=function(t){this.heap.foreach(t)},t.prototype.clone=function(){var e=new t;return e.heap=this.heap.clone(),e},t}();e.PriorityQueue=a}.apply(e,[n,e]),void 0===r||(t.exports=r)},206:(t,e,n)=>{var r;r=function(t,e){"use strict";function n(t,e,n,a,o,i){for(var s=t,c=e;;){for(var u=s,l=c;0!==c&&!o(s,c-1);)c--;for(;0!==s&&!o(s-1,c);)s--;if(s===u&&c===l)break}r(s,c,n,a,o,i)}function r(t,e,a,o,i,s){var c=0;do{var u=0,l=t;if(0!==c&&i(t,e)){do{if(0==--c)return}while(i(++t,e));l=t}else for(;0!==t&&!i(t-1,e);u++,c++)s(--t,e),0===e||i(t,e-1)||n(t,e-1,a,o,i,s);for(;l<a&&!i(l,e);u++,l++)s(l,e);if(u<c)for(var h=t+c;++l<h;)i(l,e)||r(l,e,a,o,i,s);else if(u>c&&0!==e)for(var f=t+c;++f<l;)i(f,e-1)||n(f,e-1,a,o,i,s);c=u}while(0!==c&&++e<o)}Object.defineProperty(e,"__esModule",{value:!0}),e.fill=void 0,e.fill=n}.apply(e,[n,e]),void 0===r||(t.exports=r)},877:(t,e,n)=>{var r,a;r=[n,e,n(815)],a=function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.pointToPolygonDist=e.polylabel=void 0,e.polylabel=function(t,e){void 0===e&&(e=1);for(var a=Number.MAX_VALUE,o=Number.MAX_VALUE,i=Number.MIN_VALUE,s=Number.MIN_VALUE,c=0;c<t[0].length;c++){var u=t[0][c];u.x<a&&(a=u.x),u.y<o&&(o=u.y),u.x>i&&(i=u.x),u.y>s&&(s=u.y)}var l=i-a,h=s-o,f=Math.min(l,h),d=f/2,p=new n.PriorityQueue;if(0===f)return{pt:{x:a,y:o},distance:0};for(var g=a;g<i;g+=f)for(var y=o;y<s;y+=f)p.enqueue(new r(g+d,y+d,d,t));var v=function(t){for(var e=0,n=0,a=0,o=t[0],i=0,s=o.length,c=s-1;i<s;c=i++){var u=o[i],l=o[c],h=u.x*l.y-l.x*u.y;n+=(u.x+l.x)*h,a+=(u.y+l.y)*h,e+=3*h}return 0===e?new r(o[0].x,o[0].y,0,t):new r(n/e,a/e,0,t)}(t),b=new r(a+l/2,o+h/2,0,t);for(b.d>v.d&&(v=b),p.size;p.size>0;){var m=p.dequeue();m.d>v.d&&(v=m),m.max-v.d<=e||(d=m.h/2,p.enqueue(new r(m.x-d,m.y-d,d,t)),p.enqueue(new r(m.x+d,m.y-d,d,t)),p.enqueue(new r(m.x-d,m.y+d,d,t)),p.enqueue(new r(m.x+d,m.y+d,d,t)))}return{pt:{x:v.x,y:v.y},distance:v.d}};var r=function(){function t(t,e,n,r){this.x=t,this.y=e,this.h=n,this.d=o(t,e,r),this.max=this.d+this.h*Math.SQRT2}return t.prototype.compareTo=function(t){return t.max-this.max},t.prototype.getKey=function(){return this.x+","+this.y},t}();function a(t,e,n,r){var a=n.x,o=n.y,i=r.x-a,s=r.y-o;if(0!==i||0!==s){var c=((t-a)*i+(e-o)*s)/(i*i+s*s);c>1?(a=r.x,o=r.y):c>0&&(a+=i*c,o+=s*c)}return(i=t-a)*i+(s=e-o)*s}function o(t,e,n){for(var r=!1,o=1/0,i=0;i<n.length;i++)for(var s=n[i],c=0,u=s.length,l=u-1;c<u;l=c++){var h=s[c],f=s[l];h.y>e!=f.y>e&&t<(f.x-h.x)*(e-h.y)/(f.y-h.y)+h.x&&(r=!r),o=Math.min(o,a(t,e,h,f))}return(r?1:-1)*Math.sqrt(o)}e.pointToPolygonDist=o}.apply(e,r),void 0===a||(t.exports=a)},519:function(t,e,n){var r,a,o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(a,o){function i(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=e.call(t,i)}catch(t){o=[6,t],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};r=[n,e,n(906),n(678)],a=function(t,e,n,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),$(document).ready((function(){var t=this;$(".tabs").tabs(),$(".tooltipped").tooltip(),new r.Clipboard("canvas",!0),$("#file").change((function(t){var e=$("#file").get(0).files;if(null!==e&&e.length>0){var n=new FileReader;n.onloadend=function(){var t=document.createElement("img");t.onload=function(){var e=document.getElementById("canvas"),n=e.getContext("2d");e.width=t.naturalWidth,e.height=t.naturalHeight,n.drawImage(t,0,0)},t.onerror=function(){alert("Unable to load image")},t.src=n.result},n.readAsDataURL(e[0])}})),(0,n.loadExample)("imgSmall"),$("#btnProcess").click((function(){return o(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,(0,n.process)()];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),alert("Error: "+t),[3,3];case 3:return[2]}}))}))})),$("#chkShowLabels, #chkFillFacets, #chkShowBorders, #txtSizeMultiplier, #txtLabelFontSize, #txtLabelFontColor").change((function(){return o(t,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,(0,n.updateOutput)()];case 1:return t.sent(),[2]}}))}))})),$("#btnDownloadSVG").click((function(){(0,n.downloadSVG)()})),$("#btnDownloadPNG").click((function(){(0,n.downloadPNG)()})),$("#btnDownloadPalettePNG").click((function(){(0,n.downloadPalettePng)()})),$("#lnkTrivial").click((function(){return(0,n.loadExample)("imgTrivial"),!1})),$("#lnkSmall").click((function(){return(0,n.loadExample)("imgSmall"),!1})),$("#lnkMedium").click((function(){return(0,n.loadExample)("imgMedium"),!1}))}))}.apply(e,r),void 0===a||(t.exports=a)},963:(t,e,n)=>{var r;r=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Random=void 0;var n=function(){function t(t){this.seed=void 0===t?(new Date).getTime():t}return t.prototype.next=function(){var t=1e4*Math.sin(this.seed++);return t-Math.floor(t)},t}();e.Random=n}.apply(e,[n,e]),void 0===r||(t.exports=r)},310:(t,e,n)=>{var r;r=function(t,e){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.Settings=e.ClusteringColorSpace=void 0,function(t){t[t.RGB=0]="RGB",t[t.HSL=1]="HSL",t[t.LAB=2]="LAB"}(n=e.ClusteringColorSpace||(e.ClusteringColorSpace={}));e.Settings=function(){this.kMeansNrOfClusters=16,this.kMeansMinDeltaDifference=1,this.kMeansClusteringColorSpace=n.RGB,this.kMeansColorRestrictions=[],this.colorAliases={},this.narrowPixelStripCleanupRuns=3,this.removeFacetsSmallerThanNrOfPoints=20,this.removeFacetsFromLargeToSmall=!0,this.maximumNumberOfFacets=Number.MAX_VALUE,this.nrOfTimesToHalveBorderSegments=2,this.resizeImageIfTooLarge=!0,this.resizeImageWidth=1024,this.resizeImageHeight=1024,this.randomSeed=(new Date).getTime()}}.apply(e,[n,e]),void 0===r||(t.exports=r)},891:(t,e,n)=>{var r;r=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BoundingBox=void 0;var n=function(){function t(){this.minX=Number.MAX_VALUE,this.minY=Number.MAX_VALUE,this.maxX=Number.MIN_VALUE,this.maxY=Number.MIN_VALUE}return Object.defineProperty(t.prototype,"width",{get:function(){return this.maxX-this.minX+1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.maxY-this.minY+1},enumerable:!1,configurable:!0}),t}();e.BoundingBox=n}.apply(e,[n,e]),void 0===r||(t.exports=r)},946:(t,e,n)=>{var r;r=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Point=void 0;var n=function(){function t(t,e){this.x=t,this.y=e}return t.prototype.distanceTo=function(t){return Math.abs(t.x-this.x)+Math.abs(t.y-this.y)},t.prototype.distanceToCoord=function(t,e){return Math.abs(t-this.x)+Math.abs(e-this.y)},t}();e.Point=n}.apply(e,[n,e]),void 0===r||(t.exports=r)},297:(t,e,n)=>{var r;r=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BooleanArray2D=e.Uint8Array2D=e.Uint32Array2D=void 0;var n=function(){function t(t,e){this.width=t,this.height=e,this.arr=new Uint32Array(t*e)}return t.prototype.get=function(t,e){return this.arr[e*this.width+t]},t.prototype.set=function(t,e,n){this.arr[e*this.width+t]=n},t}();e.Uint32Array2D=n;var r=function(){function t(t,e){this.width=t,this.height=e,this.arr=new Uint8Array(t*e)}return t.prototype.get=function(t,e){return this.arr[e*this.width+t]},t.prototype.set=function(t,e,n){this.arr[e*this.width+t]=n},t.prototype.matchAllAround=function(t,e,n){var r=e*this.width+t;return t-1>=0&&this.arr[r-1]===n&&e-1>=0&&this.arr[r-this.width]===n&&t+1<this.width&&this.arr[r+1]===n&&e+1<this.height&&this.arr[r+this.width]===n},t}();e.Uint8Array2D=r;var a=function(){function t(t,e){this.width=t,this.height=e,this.arr=new Uint8Array(t*e)}return t.prototype.get=function(t,e){return 0!==this.arr[e*this.width+t]},t.prototype.set=function(t,e,n){this.arr[e*this.width+t]=n?1:0},t}();e.BooleanArray2D=a}.apply(e,[n,e]),void 0===r||(t.exports=r)}},e={};!function n(r){var a=e[r];if(void 0!==a)return a.exports;var o=e[r]={exports:{}};return t[r].call(o.exports,o,o.exports,n),o.exports}(519)})();
//# sourceMappingURL=main.js.map